(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-793fe877"],{"3c65":function(e,t,a){"use strict";var n=a("23e7"),r=a("7b0b"),i=a("07fa"),o=a("3a34"),s=a("083a"),c=a("3511"),l=1!==[].unshift(0),u=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}},d=l||!u();n({target:"Array",proto:!0,arity:1,forced:d},{unshift:function(e){var t=r(this),a=i(t),n=arguments.length;if(n){c(a+n);var l=a;while(l--){var u=l+n;l in t?t[u]=t[l]:s(t,u)}for(var d=0;d<n;d++)t[d]=arguments[d]}return o(t,a+n)}})},"673d":function(e,t,a){"use strict";a.d(t,"f",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"g",(function(){return c})),a.d(t,"b",(function(){return l})),a.d(t,"m",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"a",(function(){return h})),a.d(t,"j",(function(){return m})),a.d(t,"k",(function(){return f})),a.d(t,"l",(function(){return p})),a.d(t,"h",(function(){return b}));var n=a("b775");function r(e){return Object(n["a"])({url:"auth/point-list",params:e})}function i(e){return Object(n["a"])({url:"auth/point-del",method:"post",data:e})}function o(e){return Object(n["a"])({url:"auth/point-add",method:"post",data:e})}function s(e){return Object(n["a"])({url:"auth/point-edit",method:"post",data:e})}function c(e){return Object(n["a"])({url:"auth/role-list",params:e})}function l(e){return Object(n["a"])({url:"auth/all-auth",params:e})}function u(e){return Object(n["a"])({url:"auth/edit-role",method:"post",data:e})}function d(e){return Object(n["a"])({url:"auth/del-role",params:e})}function h(e){return Object(n["a"])({url:"auth/edit-backend-member",method:"post",data:e})}function m(e){return Object(n["a"])({url:"auth/role-enums",method:"post",data:e})}function f(e){return Object(n["a"])({url:"auth/backend-member-list",params:e})}function p(e){return Object(n["a"])({url:"auth/change-backend-member-status",params:e})}function b(e){return Object(n["a"])({url:"auth/del-backend-member",params:e})}},7096:function(e,t,a){"use strict";a("baea")},8055:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"page-card",attrs:{shadow:"never"}},[a("SearchForm",{ref:"searchForm",attrs:{"search-config":e.searchConfig},on:{search:e.onSearch,init:e.onInit}}),a("div",[a("TablePackage",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"storage-name":"set-role",size:e.$size,border:"","header-cell-style":{"text-align":"center",background:"#fafafa"},"cell-style":{"text-align":"center"}},on:{"selection-change":e.handleSelectionChange},scopedSlots:e._u([{key:"btnContentLeft",fn:function(){return[a("el-button",{directives:[{name:"setButtonPower",rawName:"v-setButtonPower",value:"set-role-add",expression:"'set-role-add'"}],attrs:{size:e.$s_size,type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleClick("add")}}},[e._v("新 增")]),a("el-button",{directives:[{name:"setButtonPower",rawName:"v-setButtonPower",value:"set-role-del",expression:"'set-role-del'"}],attrs:{size:e.$s_size,type:"plain",icon:"el-icon-delete"},on:{click:e.delMoreItem}},[e._v("刪 除")])]},proxy:!0},{key:"btnContentRight",fn:function(){return[a("el-tooltip",{staticClass:"item table-top-btn",attrs:{effect:"dark",content:e.searchShow?"關閉搜索":"打開搜索",placement:"top"}},[a("el-button",{attrs:{size:"mini",circle:"",icon:"el-icon-search"},on:{click:function(t){e.searchShow=!e.searchShow}}})],1),a("el-tooltip",{staticClass:"item table-top-btn",attrs:{effect:"dark",content:"刷新列表",placement:"top"}},[a("el-button",{attrs:{size:"mini",circle:"",icon:"el-icon-refresh"},on:{click:e.getData}})],1)]},proxy:!0}])},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"name",label:"權限名稱","min-width":"150"}}),a("el-table-column",{attrs:{prop:"count",label:"用戶數量","min-width":"150"}}),a("el-table-column",{attrs:{prop:"created_at",label:"添加時間","min-width":"150"}}),a("el-table-column",{staticClass:"operate-table",attrs:{label:"操作",width:"80",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.tableData.length?a("el-dropdown",{attrs:{trigger:"click",size:"small",placement:"bottom-end","hide-on-click":!1},on:{command:function(a){e.handleClick(a,t.row,t.$index)}}},[a("span",{staticClass:"el-dropdown-link"},[e._v(" ... ")]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{directives:[{name:"setButtonPower",rawName:"v-setButtonPower",value:"set-role-edit",expression:"'set-role-edit'"}],attrs:{command:"edit"}},[e._v("編輯")]),a("el-dropdown-item",{directives:[{name:"setButtonPower",rawName:"v-setButtonPower",value:"set-role-del",expression:"'set-role-del'"}],attrs:{disabled:t.row.count>0,command:"del"}},[e._v("刪除")])],1)],1):e._e()]}}])})],1),a("div",{staticClass:"footerpage"},[a("el-pagination",{attrs:{background:"","current-page":e.searchForm.page,"page-size":e.searchForm.page_size,layout:"total,  prev, pager, next, jumper",total:e.searchForm.total},on:{"current-change":e.handleCurrentChange}})],1)],1)],1),a("Set",{ref:"Set",on:{getData:e.getData}})],1)},r=[],i=a("c7eb"),o=a("1da1"),s=(a("d81d"),a("b0c0"),a("21fd")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{"close-on-click-modal":!1,title:{add:"新增角色",edit:"編輯角色"}[e.mode],"before-close":e.handleClose,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{"label-position":"top",model:e.ruleForm,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"角色名稱：",prop:"name"}},[a("el-input",{attrs:{clearable:"",placeholder:"請輸入角色名稱"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),a("el-form-item",{attrs:{label:"角色權限：",required:""}},[e.dialogFormVisible?a("el-tree",{ref:"tree",attrs:{data:e.treeData,"show-checkbox":"","check-on-click-node":"","node-key":"id","default-expand-all":!0,"default-checked-keys":e.defaultCheckedKeys,props:{children:"child",label:"name"}}}):e._e()],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:e.$s_size},on:{click:e.handleClose}},[e._v("取 消")]),a("el-button",{attrs:{size:e.$s_size,type:"primary"},on:{click:e.submitForm}},[e._v("確 定")])],1)],1)],1)},l=[],u=(a("d3b7"),a("159b"),a("3c65"),a("9418")),d=a("673d"),h={name:"",data:function(){return{mode:"",dialogFormVisible:!1,defaultCheckedKeys:[],ruleForm:{id:0,name:"",auth:[]},treeData:[],rules:{name:[{required:!0,message:"必填",trigger:"blur"}],auth:[{type:"array",required:!0,message:"必填",trigger:"change"}]}}},computed:{},created:function(){},methods:{handleClose:function(){this.ruleForm={id:0,name:"",auth:[]},this.defaultCheckedKeys=[],this.$refs.ruleForm.resetFields(),this.dialogFormVisible=!1},onInit:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var a,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["b"])();case 2:a=t.sent,n=a.data,n.forEach((function(e){e.child?e.child.unshift({id:e.id,is_choice:!1,name:"頁面權限"}):e.child=[{id:e.id,is_choice:!1,name:"頁面權限"}]})),e.treeData=n;case 6:case"end":return t.stop()}}),t)})))()},submitForm:function(){var e=this;if(this.ruleForm.auth=this.$refs.tree.getCheckedKeys(!0),!this.ruleForm.auth.length)return Object(u["a"])("請選擇角色權限！");this.$refs.ruleForm.validate(function(){var t=Object(o["a"])(Object(i["a"])().mark((function t(a){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return",Object(u["a"])("請按要求填寫！"));case 2:return t.next=4,Object(d["m"])(e.ruleForm);case 4:Object(u["a"])(e,"操作成功！","success"),e.$emit("getData"),e.handleClose();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},m=h,f=(a("7096"),a("2877")),p=Object(f["a"])(m,c,l,!1,null,"6e66a332",null),b=p.exports,g=a("c6e7"),w=a("0272"),v={name:"SetRole",components:{TablePackage:s["a"],Set:b,SearchForm:w["a"]},mixins:[g["a"]],data:function(){return{loading:!1,searchShow:!0,searchConfig:[{key:"name",type:"input",label:"角色名稱",value:""}],tableData:[],delList:[]}},computed:{},created:function(){},methods:{getData:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var a,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(d["g"])(e.getSearchOptions());case 3:a=t.sent,n=a.data,e.loading=!1,e.tableData=n.data,e.searchForm.total=n.total;case 8:case"end":return t.stop()}}),t)})))()},reset:function(){this.loading=!0,Object.assign(this.$data.searchForm,this.$options.data().searchForm),this.getData()},search:function(){this.loading=!0,this.searchForm.page=1,this.getData()},handleSelectionChange:function(e){this.delList=e},handleCurrentChange:function(e){this.loading=!0,this.searchForm.page=e,this.getData()},delMoreItem:function(){var e=this;if(this.delList.length<=0)return Object(u["a"])(this,"最少選擇一條需要刪除的數據");this.$confirm("是否確定刪除".concat(this.delList.length,"條數據"),"提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.delList.map((function(e){return e.id})),t.next=3,Object(d["i"])({id:a});case 3:Object(u["a"])(e,"操作成功！","success"),e.getData();case 5:case"end":return t.stop()}}),t)})))).catch((function(){}))},delItem:function(e){var t=this;return Object(o["a"])(Object(i["a"])().mark((function a(){return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(d["i"])({id:[e.id]});case 2:Object(u["a"])(t,"操作成功！","success"),t.getData();case 4:case"end":return a.stop()}}),a)})))()},handleClick:function(e,t){var a=this;this.$refs.Set.mode=e,"add"===e&&(this.$refs.Set.onInit(),this.$refs.Set.defaultCheckedKeys=[]),"edit"===e&&(this.$refs.Set.onInit(),this.$refs.Set.ruleForm.id=t.id,this.$refs.Set.ruleForm.name=t.name,this.$refs.Set.defaultCheckedKeys=t.auth,this.$refs.Set.ruleForm.auth=t.auth),"del"!==e?this.$refs.Set.dialogFormVisible=!0:this.$confirm("是否確認刪除该條數據？","提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then((function(){a.delItem(t)})).catch((function(){}))}}},k=v,F=Object(f["a"])(k,n,r,!1,null,"f8c19e22",null);t["default"]=F.exports},baea:function(e,t,a){},c6e7:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n={data:function(){return{searchShow:!0,options:{},searchForm:{page:1,page_size:10,total:0},selectList:[],message:{},eventEnum:{del:"onDel",add:"onAdd",edit:"onEdit",batchDel:"onBatchDel"}}},methods:{getSearchOptions:function(){return this.$refs.searchForm?Object.assign({},this.searchForm,this.$refs.searchForm.searchForm):this.searchForm},onInit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.$refs.searchForm?this.$refs.searchForm.searchForm:{},a=Object.assign({},e,this.$options.data().searchForm,t);this.searchForm=a,this.getData()},onSearch:function(){this.searchForm.page=1,this.getData()},onCancel:function(){this.isShow=!1},handleSelectionChange:function(e){this.selectList=e},handleCurrentChange:function(e){this.loading=!0,this.searchForm.page=e,this.getData()}}}}}]);